<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ELEGANCE - Khám phá phong cách thời trang tinh tế và đẳng cấp.">
    <meta name="keywords" content="thời trang, elegance, quần áo, phụ kiện, cửa hàng trực tuyến, sang trọng">
    <title>ELEGANCE - Trải nghiệm Mua sắm Tinh tế</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Lora:wght@400;600&family=Roboto:wght@300;400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --font-heading: 'Playfair Display', serif;
            --font-subheading: 'Lora', serif;
            --font-body: 'Roboto', sans-serif;
            --color-accent: #c0a183;
            --color-accent-dark: #a1866c;
            --color-bg-dark: #121212;
            --color-text-dark: #e0d8cd;
            --color-card-dark: #1d1d1d;
            --color-header-dark: rgba(18, 18, 18, 0.85);
            --color-shadow: rgba(0, 0, 0, 0.25);
            --transition-speed: 0.4s;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: var(--font-body);
            background: linear-gradient(135deg, #1a1a1a 0%, #121212 50%, #0a0a0a 100%);
            color: var(--color-text-dark);
            overflow-x: hidden;
            line-height: 1.7;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            position: relative;
        }
        body.modal-open { overflow: hidden; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--color-bg-dark); }
        ::-webkit-scrollbar-thumb { background: var(--color-accent); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--color-accent-dark); }

        /* Animations */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .animate-on-scroll {
            opacity: 0;
            animation: fadeInUp 0.8s var(--transition-speed) ease-out forwards;
        }
        .float-animation { animation: float 4s ease-in-out infinite; }
        .pulse-animation:hover { animation: pulse 1s ease-in-out infinite; }

        /* Background Particles */
        #particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        /* Preloader */
        .preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--color-bg-dark);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease;
        }
        .preloader .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #333;
            border-top-color: var(--color-accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        .container { max-width: 1200px; margin: 0 auto; padding: 0 15px; }
        .section { padding: 100px 0; }
        .section-title {
            font-family: var(--font-heading);
            font-size: clamp(2rem, 5vw, 2.5rem);
            text-align: center;
            margin-bottom: 60px;
            letter-spacing: 1px;
            color: var(--color-accent);
            position: relative;
        }
        .section-title::after {
            content: '';
            width: 60px;
            height: 3px;
            background: var(--color-accent);
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            animation: pulse 2s infinite;
        }
        .btn {
            display: inline-block;
            padding: 14px 35px;
            background-color: var(--color-accent);
            color: #fff;
            text-decoration: none;
            border-radius: 5px;
            font-family: var(--font-subheading);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            will-change: transform, box-shadow;
            border: none;
            width: 100%;
            text-align: center;
        }
        .btn:hover {
            background-color: var(--color-accent-dark);
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
            animation: pulse 1s ease-in-out;
        }

        /* Header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            background-color: var(--color-header-dark);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 20px 0;
            box-shadow: 0 2px 5px var(--color-shadow);
            transition: transform 0.3s ease;
        }
        .nav-container { display: flex; justify-content: space-between; align-items: center; }
        .logo {
            font-family: var(--font-heading);
            font-size: 30px;
            text-decoration: none;
            color: var(--color-accent);
            letter-spacing: 2px;
            transition: transform 0.3s ease;
        }
        .logo:hover { transform: scale(1.05); }
        .nav-toggle { display: none; font-size: 24px; background: none; border: none; color: var(--color-text-dark); cursor: pointer; }
        nav ul { list-style: none; display: flex; gap: 30px; }
        nav a { text-decoration: none; color: var(--color-text-dark); font-family: var(--font-subheading); font-weight: 400; padding: 8px 0; position: relative; }
        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background-color: var(--color-accent);
            transition: width var(--transition-speed) ease;
        }
        nav a:hover::after, nav a.active::after { width: 100%; }

        /* Banner */
        .banner {
            height: 100vh;
            background-image: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1571513722275-4b41940f54b8?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-position: center 70%;
            background-attachment: fixed;
            display: flex; justify-content: center; align-items: center;
            text-align: center; color: #fff;
            position: relative;
            overflow: hidden;
        }
        .banner-content { max-width: 800px; padding: 20px; animation: fadeInUp 1s ease-out; z-index: 2; }
        .banner h1 { font-family: var(--font-heading); font-size: clamp(2.5rem, 8vw, 4rem); margin-bottom: 20px; text-shadow: 0 3px 6px rgba(0,0,0,0.5); }
        .banner p { font-family: var(--font-subheading); font-size: clamp(1rem, 3vw, 1.2rem); margin-bottom: 40px; opacity: 0.9; }
        .banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 5s infinite;
            z-index: 1;
        }

        /* Product Grid */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 40px;
        }
        .product-card {
            background-color: var(--color-card-dark);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px var(--color-shadow);
            transition: all var(--transition-speed) ease;
            position: relative;
            opacity: 0;
        }
        .product-card:hover { transform: translateY(-8px); box-shadow: 0 12px 25px rgba(0,0,0,0.3); }
        .product-card.is-new::before {
            content: 'Mới';
            position: absolute;
            top: 15px;
            left: 15px;
            background-color: var(--color-accent);
            color: #fff;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            font-weight: bold;
            z-index: 2;
            animation: pulse 2s infinite;
        }
        .product-image-container { position: relative; height: 350px; overflow: hidden; }
        .product-card img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.7s ease; }
        .product-card:hover img { transform: scale(1.1); }
        .product-info { padding: 25px; text-align: center; }
        .product-info h3 { font-family: var(--font-subheading); font-size: 22px; margin-bottom: 10px; }
        .product-info .price { font-weight: 400; color: var(--color-accent); font-size: 18px; }
        .product-overlay {
            position: absolute;
            bottom: 0; left: 0; width: 100%; padding: 20px;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            opacity: 0;
            transform: translateY(20px);
            transition: all var(--transition-speed) ease;
        }
        .product-card:hover .product-overlay { opacity: 1; transform: translateY(0); }
        .view-details-btn { font-size: 16px; padding: 12px; }

        /* --- MODAL STYLES (Chung cho cả 2 modal) --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.9);
            z-index: 1001;
            display: flex; align-items: center; justify-content: center;
            opacity: 0; visibility: hidden;
            transition: opacity var(--transition-speed) ease, visibility var(--transition-speed) ease;
        }
        .modal-overlay.visible { opacity: 1; visibility: visible; }
        .modal-content-base {
            background-color: var(--color-card-dark);
            width: 90%;
            padding: 40px; border-radius: 15px; position: relative;
            box-shadow: 0 15px 30px var(--color-shadow);
            animation: scaleIn 0.5s ease-out forwards;
            max-height: 90vh;
            overflow-y: auto;
        }
        .close-modal-btn {
            position: absolute; top: 15px; right: 20px;
            font-size: 32px; background: none; border: none;
            color: var(--color-text-dark); cursor: pointer; transition: color 0.3s ease, transform 0.3s ease;
            z-index: 10;
        }
        .close-modal-btn:hover { color: var(--color-accent); transform: rotate(90deg); }

        /* Detail Modal */
        #detail-modal .modal-content {
            display: grid; grid-template-columns: 1fr 1fr; gap: 40px;
            max-width: 900px;
        }
        .modal-gallery { position: relative; }
        .modal-main-image {
            width: 100%; height: 500px;
            object-fit: cover; border-radius: 10px;
            transition: opacity 0.3s ease-in-out;
        }
        .modal-main-image.is-switching { opacity: 0.5; }
        .gallery-nav {
            position: absolute; top: 50%; width: 100%;
            display: flex; justify-content: space-between;
            transform: translateY(-50%);
            padding: 0 10px;
            opacity: 0; transition: opacity var(--transition-speed) ease;
        }
        .modal-gallery:hover .gallery-nav { opacity: 1; }
        .gallery-nav button {
            background-color: rgba(0,0,0,0.5); color: #fff;
            border: none; border-radius: 50%;
            width: 45px; height: 45px; cursor: pointer;
            font-size: 20px; transition: background-color 0.3s ease;
        }
        .gallery-nav button:hover { background-color: var(--color-accent); }
        .modal-info h2 { font-family: var(--font-heading); font-size: 32px; margin-bottom: 15px; }
        .modal-info .price { color: var(--color-accent); font-size: 24px; margin-bottom: 25px; }
        .modal-info h3 { margin-bottom: 15px; font-size: 16px; font-weight: 400; }
        .size-selector { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 30px; }
        .size-btn {
            width: 45px; height: 45px; border: 2px solid #444; background: none; color: var(--color-text-dark);
            cursor: pointer; border-radius: 5px; font-family: var(--font-body);
            transition: all 0.3s ease;
        }
        .size-btn:hover { border-color: var(--color-accent); }
        .size-btn.active { border-color: var(--color-accent); background-color: var(--color-accent); color: #fff; }
        
        /* --- Checkout Modal --- */
        #checkout-modal .checkout-content {
            max-width: 550px;
            text-align: left;
        }
        .checkout-content h2 {
            font-family: var(--font-heading);
            color: var(--color-accent);
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
        }
        .checkout-summary {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 4px solid var(--color-accent);
        }
        .checkout-summary p { margin: 5px 0; }
        .checkout-summary .product-name { font-family: var(--font-subheading); font-weight: 600; font-size: 18px; }

        .checkout-form .form-group { margin-bottom: 20px; }
        .checkout-form label { display: block; margin-bottom: 8px; font-weight: 300; }
        .checkout-form input {
            width: 100%;
            padding: 12px;
            background-color: #2a2a2a;
            border: 1px solid #444;
            border-radius: 5px;
            color: var(--color-text-dark);
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        .checkout-form input:focus {
            outline: none;
            border-color: var(--color-accent);
        }
        .checkout-form .btn { margin-top: 10px; }
        
        /* Footer */
        footer { background-color: #0a0a0a; color: #a09787; padding: 80px 0 40px; position: relative; }
        .footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 40px; margin-bottom: 50px; }
        .footer-col h4 { font-family: var(--font-heading); margin-bottom: 20px; font-size: 22px; color: var(--color-accent); }
        .footer-col ul { list-style: none; }
        .footer-col li { margin-bottom: 12px; }
        .footer-col a { text-decoration: none; color: #a09787; font-weight: 300; transition: color 0.3s ease; }
        .footer-col a:hover { color: var(--color-accent); }
        .social-links a { margin-right: 20px; font-size: 20px; color: #a09787; transition: color 0.3s ease; }
        .social-links a:hover { color: var(--color-accent); animation: float 2s infinite; }
        .footer-bottom { text-align: center; font-size: 14px; color: #666; padding-top: 40px; border-top: 1px solid #222; }

        /* Responsive */
        @media (max-width: 900px) {
            #detail-modal .modal-content {
                grid-template-columns: 1fr;
                max-width: 500px;
                padding: 30px;
            }
            .modal-main-image { height: 400px; }
        }

        @media (max-width: 768px) {
            .nav-toggle { display: block; z-index: 1001; }
            nav {
                position: fixed; top: 0; right: 0; width: 280px; height: 100%;
                background-color: var(--color-card-dark);
                transform: translateX(100%);
                transition: transform 0.4s cubic-bezier(0.23, 1, 0.32, 1);
                padding: 100px 30px;
                display: flex;
                flex-direction: column;
                justify-content: center;
            }
            nav.active { transform: translateX(0); }
            nav ul { flex-direction: column; gap: 25px; align-items: center; }
            nav a { font-size: 20px; }
            .banner { height: 80vh; background-attachment: scroll; }
            .product-grid { grid-template-columns: 1fr; }
            .footer-grid { grid-template-columns: 1fr; text-align: center; }
            .social-links { margin: 20px 0; }
        }
    </style>
</head>
<body>
    <div id="particles"></div>
    <div class="preloader">
        <div class="spinner"></div>
    </div>

    <header id="main-header">
        <div class="container nav-container">
            <a href="#home" class="logo">ELEGANCE</a>
            <button class="nav-toggle"><i class="fas fa-bars"></i></button>
            <nav>
                <ul>
                    <li><a href="#home">Trang Chủ</a></li>
                    <li><a href="#about">Về Chúng Tôi</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div id="detail-modal" class="modal-overlay"></div>
    
    <div id="checkout-modal" class="modal-overlay"></div>

    <main>
        <section id="home" class="banner">
            <div class="banner-content">
                <h1 class="float-animation">Thời Trang Vượt Thời Gian</h1>
                <p>Khám phá những bộ sưu tập tinh tế, nơi phong cách và đẳng cấp hội tụ.</p>
                <a href="#products" class="btn pulse-animation">Khám Phá Bộ Sưu Tập</a>
            </div>
        </section>

        <section id="products" class="section">
            <div class="container">
                <h2 class="section-title animate-on-scroll">Sản Phẩm Nổi Bật</h2>
                <div class="product-grid">
                    </div>
            </div>
        </section>

        <section id="about" class="section" style="background-color: #0a0a0a;">
            <div class="container animate-on-scroll" style="text-align: center; max-width: 800px;">
                <h2 class="section-title">Về ELEGANCE</h2>
                <p style="font-family: var(--font-subheading); font-size: 18px; line-height: 1.8; color: #b0a595;">
                    ELEGANCE không chỉ là thời trang, đó là tuyên ngôn về phong cách sống. Chúng tôi tin rằng sự thanh lịch đích thực đến từ những thiết kế vượt thời gian, được chế tác tỉ mỉ từ chất liệu cao cấp nhất, nhằm tôn vinh sự tự tin và nét đẹp riêng của mỗi người.
                </p>
            </div>
        </section>
    </main>

    <footer id="contact">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h4>ELEGANCE</h4>
                    <p>Thời trang tinh xảo, đẳng cấp vượt thời gian.</p>
                </div>
                <div class="footer-col">
                    <h4>Theo Dõi</h4>
                    <div class="social-links">
                        <a href="https://facebook.com/your-page" target="_blank"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://zalo.me/0987654321" target="_blank"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/91/Icon_of_Zalo.svg/32px-Icon_of_Zalo.svg.png" alt="Zalo" style="width: 24px; height: 24px; vertical-align: middle;"></a>
                        <a href="https://tiktok.com/@yourusername" target="_blank"><i class="fab fa-tiktok"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>© 2025 ELEGANCE. Thiết kế bởi Trí Tuệ Nhân Tạo.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- DATA ---
        const productData = [
            { id: 1, name: "Áo Trench Coat Vải Kaki", price: 2500000, isNew: true, images: ["https://i.postimg.cc/K8hMD1Vk/z6727422682364-ea5cf189ed63a66d8aec5c63007fec5b.jpg", "https://images.unsplash.com/photo-1551028719-00167b16eac5?q=80&w=1935&auto=format&fit=crop", "https://images.unsplash.com/photo-1612287231670-c31a851cd9aa?q=80&w=1935&auto=format&fit=crop"], sizes: ["S", "M", "L"] },
            { id: 2, name: "Váy Lụa Cổ Điển", price: 1900000, isNew: false, images: ["https://images.unsplash.com/photo-1525507119028-ed4c629203d3?q=80&w=1974&auto=format&fit=crop", "https://images.unsplash.com/photo-1595950653106-6c9ebd614d3a?q=80&w=1974&auto=format&fit=crop", "https://images.unsplash.com/photo-1611262617038-2a94a7b014e2?q=80&w=1974&auto=format&fit=crop"], sizes: ["S", "M"] },
            { id: 3, name: "Giày Oxford Da Thật", price: 3200000, isNew: true, images: ["https://images.unsplash.com/photo-1543163521-1bf539c55dd2?q=80&w=2080&auto=format&fit=crop", "https://images.unsplash.com/photo-1600185365926-3a2ce3cdb9eb?q=80&w=1928&auto=format&fit=crop", "https://images.unsplash.com/photo-1560769629-9758109df174?q=80&w=2070&auto=format&fit=crop"], sizes: ["39", "40", "41", "42"] },
            { id: 4, name: "Túi Tote Da Bê", price: 4500000, isNew: false, images: ["https://images.unsplash.com/photo-1591195857868-2b3565eecf19?q=80&w=1974&auto=format&fit=crop", "https://images.unsplash.com/photo-1571653108878-bab53090f975?q=80&w=1974&auto=format&fit=crop"], sizes: ["One Size"] },
        ];

        // --- STATE ---
        let currentProductInModal = null;
        let currentImageIndex = 0;
        let selectedSize = null;

        // --- DOM ELEMENTS ---
        const preloader = document.querySelector('.preloader');
        const body = document.body;
        const productGrid = document.querySelector('.product-grid');
        const detailModal = document.getElementById('detail-modal');
        const checkoutModal = document.getElementById('checkout-modal'); // Mới
        const navToggle = document.querySelector('.nav-toggle');
        const nav = document.querySelector('nav');

        // --- PARTICLES.JS ---
        particlesJS('particles', { particles: { number: { value: 50, density: { enable: true, value_area: 800 } }, color: { value: '#c0a183' }, shape: { type: 'circle' }, opacity: { value: 0.5, random: true, anim: { enable: true, speed: 1, opacity_min: 0.1, sync: false } }, size: { value: 3, random: true, anim: { enable: true, speed: 2, size_min: 0.1, sync: false } }, move: { enable: true, speed: 1, direction: 'none', random: true, straight: false, out_mode: 'out' } }, interactivity: { detect_on: 'canvas', events: { onhover: { enable: true, mode: 'repulse' }, onclick: { enable: true, mode: 'push' }, resize: true }, modes: { repulse: { distance: 100, duration: 0.4 }, push: { particles_nb: 4 } } }, retina_detect: true });

        // --- FUNCTIONS ---
        function renderProducts() {
            productGrid.innerHTML = '';
            productData.forEach((product, index) => {
                const card = document.createElement('div');
                card.className = `product-card ${product.isNew ? 'is-new' : ''}`;
                card.style.animation = `fadeInUp 0.8s ${index * 100}ms ease-out forwards`;
                card.innerHTML = `
                    <div class="product-image-container">
                        <img src="${product.images[0]}" alt="${product.name}" loading="lazy">
                        <div class="product-overlay">
                            <button class="btn view-details-btn pulse-animation" data-id="${product.id}">Xem Chi Tiết</button>
                        </div>
                    </div>
                    <div class="product-info">
                        <h3>${product.name}</h3>
                        <p class="price">${product.price.toLocaleString('vi-VN')} VNĐ</p>
                    </div>`;
                productGrid.appendChild(card);
            });
        }

        function createDetailModalContent(product) {
            detailModal.innerHTML = `
                <div class="modal-content-base modal-content">
                    <button class="close-modal-btn">×</button>
                    <div class="modal-gallery">
                        <img src="${product.images[0]}" alt="${product.name}" class="modal-main-image">
                        <div class="gallery-nav">
                            <button class="gallery-nav-btn" data-direction="-1"><</button>
                            <button class="gallery-nav-btn" data-direction="1">></button>
                        </div>
                    </div>
                    <div class="modal-info">
                        <h2>${product.name}</h2>
                        <p class="price">${product.price.toLocaleString('vi-VN')} VNĐ</p>
                        <h3>Chọn Size:</h3>
                        <div class="size-selector">
                            ${product.sizes.map(size => `<button class="size-btn">${size}</button>`).join('')}
                        </div>
                        <button class="btn pulse-animation" id="buy-now-btn">Mua Ngay</button>
                    </div>
                </div>
            `;
            if (product.images.length <= 1) {
                detailModal.querySelector('.gallery-nav').style.display = 'none';
            }
        }
        
        // --- MỚI: Function tạo nội dung cho Checkout Modal ---
        function createCheckoutModalContent(product, size) {
            checkoutModal.innerHTML = `
                <div class="modal-content-base checkout-content">
                    <button class="close-modal-btn">×</button>
                    <h2>Thông Tin Đặt Hàng</h2>
                    
                    <div class="checkout-summary">
                        <p><strong>Sản phẩm:</strong> <span class="product-name">${product.name}</span></p>
                        <p><strong>Size:</strong> ${size}</p>
                        <p><strong>Giá:</strong> <span class="price">${product.price.toLocaleString('vi-VN')} VNĐ</span></p>
                    </div>
                    
                    <form class="checkout-form" id="checkout-form">
                        <div class="form-group">
                            <label for="fullName">Họ và Tên</label>
                            <input type="text" id="fullName" name="fullName" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Số Điện Thoại</label>
                            <input type="tel" id="phone" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label for="address">Địa Chỉ Nhận Hàng</label>
                            <input type="text" id="address" name="address" required>
                        </div>
                        <button type="submit" class="btn">Xác Nhận Đơn Hàng</button>
                    </form>
                </div>
            `;
        }

        function openDetailModal(productId) {
            currentProductInModal = productData.find(p => p.id == productId);
            if (!currentProductInModal) return;

            currentImageIndex = 0;
            selectedSize = null; // Reset size khi mở modal mới
            createDetailModalContent(currentProductInModal);
            
            detailModal.classList.add('visible');
            body.classList.add('modal-open');
        }

        function closeDetailModal() {
            detailModal.classList.remove('visible');
            body.classList.remove('modal-open');
            setTimeout(() => { detailModal.innerHTML = ''; }, 500);
        }

        // --- MỚI: Function mở và đóng Checkout Modal ---
        function openCheckoutModal() {
            createCheckoutModalContent(currentProductInModal, selectedSize);
            checkoutModal.classList.add('visible');
            body.classList.add('modal-open');
        }

        function closeCheckoutModal() {
            checkoutModal.classList.remove('visible');
            body.classList.remove('modal-open');
            setTimeout(() => { checkoutModal.innerHTML = ''; }, 500);
        }
        
        function switchImage(direction) {
            if (!currentProductInModal || currentProductInModal.images.length <= 1) return;
            
            const gallery = currentProductInModal.images;
            currentImageIndex = (currentImageIndex + direction + gallery.length) % gallery.length;

            const modalImage = detailModal.querySelector('.modal-main-image');
            modalImage.classList.add('is-switching');

            setTimeout(() => {
                modalImage.src = gallery[currentImageIndex];
                modalImage.onload = () => {
                    modalImage.classList.remove('is-switching');
                };
            }, 150);
        }
        
        function setupIntersectionObserver() {
            const animatedElements = document.querySelectorAll('.animate-on-scroll');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            animatedElements.forEach(el => observer.observe(el));
        }

        // --- EVENT LISTENERS ---
        window.addEventListener('load', () => {
            preloader.style.opacity = '0';
            setTimeout(() => { preloader.style.display = 'none'; }, 500);
        });

        productGrid.addEventListener('click', e => {
            const viewBtn = e.target.closest('.view-details-btn');
            if (viewBtn) {
                openDetailModal(viewBtn.dataset.id);
            }
        });

        // --- Cập nhật Event Listener cho Detail Modal ---
        detailModal.addEventListener('click', e => {
            if (e.target.matches('.close-modal-btn') || e.target.matches('#detail-modal')) closeDetailModal();
            if (e.target.closest('.gallery-nav-btn')) switchImage(parseInt(e.target.closest('.gallery-nav-btn').dataset.direction));
            
            if (e.target.matches('.size-btn')) {
                detailModal.querySelector('.size-btn.active')?.classList.remove('active');
                e.target.classList.add('active');
                selectedSize = e.target.textContent;
            }

            // Xử lý khi click "Mua Ngay"
            if (e.target.matches('#buy-now-btn')) {
                if (!selectedSize) {
                    alert('Vui lòng chọn size trước khi mua!');
                    return;
                }
                closeDetailModal();
                // Dùng setTimeout để đảm bảo modal cũ đóng mượt mà trước khi modal mới hiện
                setTimeout(() => {
                   openCheckoutModal();
                }, 300);
            }
        });
        
        // --- MỚI: Event Listener cho Checkout Modal ---
        checkoutModal.addEventListener('click', e => {
             if (e.target.matches('.close-modal-btn') || e.target.matches('#checkout-modal')) {
                closeCheckoutModal();
             }
        });
        checkoutModal.addEventListener('submit', e => {
            if(e.target.matches('#checkout-form')) {
                e.preventDefault();
                const formData = new FormData(e.target);
                const customerName = formData.get('fullName');
                // Tại đây bạn có thể xử lý dữ liệu (gửi tới server, etc.)
                // Ví dụ đơn giản là hiển thị alert
                alert(`Cảm ơn ${customerName} đã đặt hàng!\nChúng tôi sẽ sớm liên hệ với bạn để xác nhận đơn hàng.`);
                closeCheckoutModal();
            }
        });

        document.addEventListener('keydown', e => {
            if (e.key === 'Escape') {
                if (detailModal.classList.contains('visible')) closeDetailModal();
                if (checkoutModal.classList.contains('visible')) closeCheckoutModal();
            }
        });
        
        navToggle.addEventListener('click', () => {
            nav.classList.toggle('active');
            navToggle.classList.toggle('active');
        });

        // --- INITIALIZATION ---
        renderProducts();
        setupIntersectionObserver();
    });
    </script>
</body>
</html>
